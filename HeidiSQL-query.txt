CREATE DATABASE IF NOT EXISTS ASIDB;
USE ASIBD;

-- 1. Tabla Profesor
-- Se asume una PK 'idProfesor' ya que 'Contrato' e 'Informes' la referencian.
CREATE TABLE Profesor (
    idProfesor INT AUTO_INCREMENT PRIMARY KEY,
    nombreProfesor VARCHAR(255) NOT NULL,
    apellidosProfesor VARCHAR(255) NOT NULL,
    codigoCurso VARCHAR(100),
    nombreCurso VARCHAR(255),
    escuelaProfesional VARCHAR(255),
    correoInstitucional VARCHAR(255) NOT NULL UNIQUE,
    contrasena VARCHAR(255) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 2. Tabla Alumno
CREATE TABLE Alumno (
    idAlumno INT AUTO_INCREMENT PRIMARY KEY,
    nombresAlumno VARCHAR(255) NOT NULL,
    apellidosAlumno VARCHAR(255) NOT NULL,
    dni VARCHAR(20) NOT NULL UNIQUE,
    genero VARCHAR(50),
    fechaNacimiento DATE,
    ciclo VARCHAR(50),
    carrera VARCHAR(255),
    correoElectronico VARCHAR(255) NOT NULL UNIQUE,
    contrasena VARCHAR(255) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 3. Tabla EmpleadoAdministrativo
-- Se asume una PK 'idEmpleado' ya que la relaci√≥n 'Publica' con 'Oferta' la requiere.
CREATE TABLE EmpleadoAdministrativo (
    idEmpleado INT AUTO_INCREMENT PRIMARY KEY,
    nombreEmpleado VARCHAR(255) NOT NULL,
    apellidosEmpleado VARCHAR(255) NOT NULL,
    nombreEmpresa VARCHAR(255),
    correoInstitucional VARCHAR(255) NOT NULL UNIQUE,
    contrasena VARCHAR(255) NOT NULL,
    cargo VARCHAR(100)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 4. Tabla Oferta
-- Depende de EmpleadoAdministrativo
CREATE TABLE Oferta (
    idOferta INT AUTO_INCREMENT PRIMARY KEY,
    nombreEmpresa VARCHAR(255),
    descripcionPerfil TEXT,
    puestoPractica VARCHAR(255),
    requisitos TEXT,
    fechaInicio DATE,
    fechaFin DATE,
    modalidad VARCHAR(100),
    habilidadesCompetencias TEXT,
    area VARCHAR(100),
    distrito VARCHAR(100),
    beneficios TEXT,
    fechaLimiteRecepcion DATE,
    consultas TEXT,
    idEmpleado INT NOT NULL,
    FOREIGN KEY (idEmpleado) REFERENCES EmpleadoAdministrativo(idEmpleado)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 5. Tabla Contrato
-- Depende de Alumno y Profesor
CREATE TABLE Contrato (
    idContrato INT AUTO_INCREMENT PRIMARY KEY,
    idAlumno INT NOT NULL,
    idProfesor INT NOT NULL,
    fechaInicio DATE,
    fechaFin DATE,
    estadoContrato VARCHAR(50),
    documentoContrato VARCHAR(255), -- Ruta al archivo
    FOREIGN KEY (idAlumno) REFERENCES Alumno(idAlumno),
    FOREIGN KEY (idProfesor) REFERENCES Profesor(idProfesor)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 6. Tabla Informes
-- Depende de Alumno y Profesor
CREATE TABLE Informes (
    idInforme INT AUTO_INCREMENT PRIMARY KEY,
    archivo VARCHAR(255), -- Ruta al archivo
    fechaEnvio DATETIME DEFAULT CURRENT_TIMESTAMP,
    estadoInforme VARCHAR(50),
    calificacion DECIMAL(4, 2), -- Ej: 18.50
    comentariosProfesor TEXT,
    idAlumno INT NOT NULL,
    idProfesor INT NOT NULL,
    FOREIGN KEY (idAlumno) REFERENCES Alumno(idAlumno),
    FOREIGN KEY (idProfesor) REFERENCES Profesor(idProfesor)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 7. Tabla Postulacion
-- Depende de Alumno y Oferta
CREATE TABLE Postulacion (
    idPostulacion INT AUTO_INCREMENT PRIMARY KEY,
    idAlumno INT NOT NULL,
    idOferta INT NOT NULL,
    fechaPostulacion DATETIME DEFAULT CURRENT_TIMESTAMP,
    estado VARCHAR(50),
    comentarios TEXT,
    FOREIGN KEY (idAlumno) REFERENCES Alumno(idAlumno),
    FOREIGN KEY (idOferta) REFERENCES Oferta(idOferta)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;